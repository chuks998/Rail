{% load static %}
{% load humanize %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'montserrat': ['Montserrat', 'sans-serif']
                    }
                }
            }
        }
    </script>

    <title>{{user.username}} Dashboard</title>
</head>

<body class="font-montserrat bg-gradient-to-br from-slate-50 to-blue-50 min-h-screen">
    <!-- Navigation Header -->
    <nav class="bg-white/80 backdrop-blur-md shadow-lg border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center space-x-3">
                    <div class="bg-gradient-to-r from-green-600 to-green-600 p-2 rounded-lg hidden">
                        <i class="fas fa-university text-white text-lg"></i>
                    </div>
                    <div>
                        <h3
                            class="text-xl font-bold bg-gradient-to-r from-green-600 to-green-600 bg-clip-text text-transparent">
                            RAIL <span class="font-light text-gray-700 bold">SwissBank</span>
                        </h3>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <!-- Chat Icon (Outline) -->
                    <a href="{% url 'chat_list' %}" class="relative p-2 rounded-full hover:bg-green-100 transition"
                        title="Chat">
                        <i class="far fa-comments text-green-600 text-lg"></i>
                        {% if unread_chat_count > 0 %}
                        <span
                            class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full px-1.5 py-0.5 font-bold animate-pulse">
                            {{ unread_chat_count }}
                        </span>
                        {% endif %}
                    </a>
                    <!-- Notification Icon (Outline) -->
                    <div class="relative">
                        <button id="notificationBtn" class="relative p-2 rounded-full hover:bg-green-100 transition" title="Notifications">
                            <i class="far fa-bell text-green-600 text-lg"></i>
                            {% if latest_deposit|length > 0 or latest_withdraw|length > 0 or latest_history|length > 0 %}
                            <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full px-1.5 py-0.5 font-bold animate-pulse">
                                {{ latest_deposit|length|add:latest_withdraw|length|add:latest_history|length }}
                            </span>
                            {% endif %}
                        </button>
                        <!-- Notification Dropdown -->
                        <div id="notificationPanel"
                            class="hidden absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-xl border border-gray-200 max-h-96 overflow-hidden z-50">
                            <div class="px-4 py-3 border-b border-gray-100 bg-gradient-to-r from-green-50 to-emerald-50">
                                <h4 class="font-semibold text-gray-800 flex items-center gap-2">
                                    <i class="fas fa-bell text-green-600"></i>
                                    Transaction Notifications
                                </h4>
                            </div>
                            <div class="overflow-y-auto max-h-80">
                                {% if latest_deposit or latest_withdraw or latest_history %}
                                    <!-- Deposits (Latest 3) -->
                                    {% for item in latest_deposit %}
                                    {% if user.username == item.reciver_username %}
                                    <div class="px-4 py-3 hover:bg-gray-50 border-b border-gray-100 transition">
                                        <div class="flex items-start gap-3">
                                            <div class="bg-green-100 p-2 rounded-full flex-shrink-0">
                                                <i class="fas fa-arrow-down text-green-600 text-sm"></i>
                                            </div>
                                            <div class="flex-1 min-w-0">
                                                <p class="text-sm font-semibold text-gray-800">Deposit Received</p>
                                                <p class="text-xs text-gray-600 truncate">
                                                    From: <span class="font-medium">{{item.sending_user}}</span>
                                                </p>
                                                <p class="text-sm font-bold text-green-600 mt-1">+${{item.amount|intcomma}}</p>
                                            </div>
                                        </div>
                                    </div>
                                    {% endif %}
                                    {% endfor %}
                                    
                                    <!-- Withdrawals (Latest 3) -->
                                    {% for item in latest_withdraw %}
                                    <div class="px-4 py-3 hover:bg-gray-50 border-b border-gray-100 transition">
                                        <div class="flex items-start gap-3">
                                            <div class="bg-red-100 p-2 rounded-full flex-shrink-0">
                                                <i class="fas fa-arrow-up text-red-600 text-sm"></i>
                                            </div>
                                            <div class="flex-1 min-w-0">
                                                <p class="text-sm font-semibold text-gray-800">Withdrawal Processed</p>
                                                <p class="text-xs text-gray-600 truncate">
                                                    To: <span class="font-medium">{{item.bank_name}}</span>
                                                </p>
                                                <p class="text-sm font-bold text-red-600 mt-1">-${{item.amount|intcomma}}</p>
                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                    
                                    <!-- Transfers (Latest 3) -->
                                    {% for item in latest_history %}
                                    {% if user == item.sending_user %}
                                    <div class="px-4 py-3 hover:bg-gray-50 border-b border-gray-100 transition">
                                        <div class="flex items-start gap-3">
                                            <div class="bg-blue-100 p-2 rounded-full flex-shrink-0">
                                                <i class="fas fa-paper-plane text-blue-600 text-sm"></i>
                                            </div>
                                            <div class="flex-1 min-w-0">
                                                <p class="text-sm font-semibold text-gray-800">Transfer Sent</p>
                                                <p class="text-xs text-gray-600 truncate">
                                                    To: <span class="font-medium">{{item.reciver_username}}</span>
                                                </p>
                                                <p class="text-sm font-bold text-blue-600 mt-1">-${{item.amount|intcomma}}</p>
                                            </div>
                                        </div>
                                    </div>
                                    {% endif %}
                                    {% endfor %}
                                {% else %}
                                    <div class="px-4 py-8 text-center text-gray-500">
                                        <i class="fas fa-inbox text-3xl mb-2"></i>
                                        <p class="text-sm">No notifications</p>
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="text-right hidden sm:block">
                        <p class="text-sm text-gray-600">Welcome back,</p>
                        <p class="font-semibold text-gray-800">{{user.username}}</p>
                    </div>
                    <div class="relative">
                        <button id="profileMenuBtn"
                            class="w-10 h-10 bg-gradient-to-r from-green-500 to-green-500 rounded-full flex items-center justify-center hover:ring-2 hover:ring-green-300 transition-all cursor-pointer">
                            <i class="fas fa-user text-white"></i>
                        </button>
                        <!-- Dropdown Menu -->
                        <div id="profileMenu"
                            class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl border border-gray-200 py-2 z-50">
                            <div class="px-4 py-2 border-b border-gray-100">
                                <p class="text-sm font-semibold text-gray-800">{{user.username}}</p>
                                <p class="text-xs text-gray-500 hidden">{{user.email}}</p>
                            </div>
                            <a href="{% url 'logout' %}"
                                class="flex items-center gap-2 px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition">
                                <i class="fas fa-sign-out-alt"></i>
                                Logout
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Dashboard Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        {% for detail in details %}
        <!-- Account Status Alert -->
        <div class="mb-8">
            {% if detail.account_verified == True %}
            <div
                class="bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl p-4 flex items-center space-x-3">
                <div class="bg-green-100 p-2 rounded-full">
                    <i class="fas fa-check-circle text-green-600"></i>
                </div>
                <div>
                    <p class="font-semibold text-green-800">Account Verified</p>
                    <p class="text-sm text-green-600">Your account is fully verified and active</p>
                </div>
            </div>
            {% else %}
            <div
                class="bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200 rounded-xl p-4 flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="bg-amber-100 p-2 rounded-full">
                        <i class="fas fa-exclamation-triangle text-amber-600"></i>
                    </div>
                    <div>
                        <p class="font-semibold text-amber-800">Account Verification Required</p>
                        <p class="text-sm text-amber-600">Complete verification to unlock all features</p>
                    </div>
                </div>
                <button id="verifyNowBtn"
                    class="bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-white px-4 py-2 rounded-lg font-medium text-sm transition-all duration-300 transform hover:scale-105">
                    Verify Now
                </button>
            </div>
            {% endif %}
        </div>

        <!-- Balance Card -->
        <div class="mb-8">
            <div
                class="bg-gradient-to-r from-green-600 via-green-700 to-green-500 rounded-2xl shadow-2xl p-8 text-white relative overflow-hidden">
                <div class="absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full -translate-y-32 translate-x-32">
                </div>
                <div class="absolute bottom-0 left-0 w-48 h-48 bg-white/10 rounded-full translate-y-24 -translate-x-24">
                </div>
                <div class="relative z-10">
                    <div class="flex items-center justify-between mb-6">
                        <div>
                            <p class="text-white/80 text-sm font-medium">Total Balance</p>
                            <h2 class="text-4xl font-bold mt-2">
                                &dollar;{{detail.account_balance|floatformat:2|intcomma}}</h2>
                        </div>
                        <div class="bg-white/20 backdrop-blur-sm p-3 rounded-full">
                            <i class="fas fa-wallet text-2xl"></i>
                        </div>
                    </div>
                    <div class="border-t border-white/20 pt-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                            <div>
                                <p class="text-white/70">Account Number</p>
                                <p class="font-semibold">{{detail.account_number}}</p>
                            </div>
                            <div>
                                <p class="text-white/70">Account Holder</p>
                                <p class="font-semibold">{{user.first_name}} {{user.last_name}}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}

        <!-- Quick Actions -->
        <div class="mb-8">
            <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                <i class="fas fa-bolt text-blue-600 mr-2"></i>
                Quick Actions
            </h3>
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                <a href="{% url 'deposit' %}"
                    class="group bg-white rounded-xl shadow-lg hover:shadow-xl p-6 transition-all duration-300 transform hover:-translate-y-1 border border-gray-100">
                    <div class="flex items-center space-x-4">
                        <div
                            class="bg-green-100 group-hover:bg-green-200 p-3 rounded-full transition-colors duration-300">
                            <i class="fas fa-plus text-green-600 text-lg"></i>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-800">Deposit</h4>
                            <p class="text-sm text-gray-600">Add funds to account</p>
                        </div>
                    </div>
                </a>
                <a href="{% url 'withdraw' %}"
                    class="group bg-white rounded-xl shadow-lg hover:shadow-xl p-6 transition-all duration-300 transform hover:-translate-y-1 border border-gray-100">
                    <div class="flex items-center space-x-4">
                        <div class="bg-red-100 group-hover:bg-red-200 p-3 rounded-full transition-colors duration-300">
                            <i class="fas fa-minus text-red-600 text-lg"></i>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-800">Withdraw</h4>
                            <p class="text-sm text-gray-600">Transfer to bank</p>
                        </div>
                    </div>
                </a>
                <a href="{% url 'transfer' %}"
                    class="group bg-white rounded-xl shadow-lg hover:shadow-xl p-6 transition-all duration-300 transform hover:-translate-y-1 border border-gray-100">
                    <div class="flex items-center space-x-4">
                        <div
                            class="bg-blue-100 group-hover:bg-blue-200 p-3 rounded-full transition-colors duration-300">
                            <i class="fas fa-paper-plane text-blue-600 text-lg"></i>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-800">Transfer</h4>
                            <p class="text-sm text-gray-600">Send to others</p>
                        </div>
                    </div>
                </a>
            </div>
        </div>

        <!-- Market Insights & News -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Live Stock Prices -->
            <div class="bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden">
                <div class="bg-gradient-to-r from-blue-500 to-indigo-500 p-4">
                    <h4 class="font-semibold text-white flex items-center">
                        <i class="fas fa-chart-line mr-2"></i>
                        Live Stock Prices
                    </h4>
                </div>
                <div class="p-4 max-h-80 overflow-y-auto" id="stockPrices">
                    <!-- Stock prices will be loaded here -->
                    <div class="space-y-3">
                        <div class="flex items-center justify-between p-3 hover:bg-gray-50 rounded-lg transition">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                                    <i class="fas fa-chart-line text-blue-600"></i>
                                </div>
                                <div>
                                    <p class="font-semibold text-gray-800 text-sm">AAPL</p>
                                    <p class="text-xs text-gray-500">Apple Inc.</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="font-bold text-gray-800">$182.45</p>
                                <p class="text-xs text-green-600 flex items-center gap-1">
                                    <i class="fas fa-arrow-up"></i> +2.3%
                                </p>
                            </div>
                        </div>
                        <div class="flex items-center justify-between p-3 hover:bg-gray-50 rounded-lg transition">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center">
                                    <i class="fas fa-bolt text-purple-600"></i>
                                </div>
                                <div>
                                    <p class="font-semibold text-gray-800 text-sm">TSLA</p>
                                    <p class="text-xs text-gray-500">Tesla Inc.</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="font-bold text-gray-800">$248.92</p>
                                <p class="text-xs text-red-600 flex items-center gap-1">
                                    <i class="fas fa-arrow-down"></i> -1.2%
                                </p>
                            </div>
                        </div>
                        <div class="flex items-center justify-between p-3 hover:bg-gray-50 rounded-lg transition">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                                    <i class="fas fa-store text-green-600"></i>
                                </div>
                                <div>
                                    <p class="font-semibold text-gray-800 text-sm">AMZN</p>
                                    <p class="text-xs text-gray-500">Amazon.com</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="font-bold text-gray-800">$156.78</p>
                                <p class="text-xs text-green-600 flex items-center gap-1">
                                    <i class="fas fa-arrow-up"></i> +0.8%
                                </p>
                            </div>
                        </div>
                        <div class="flex items-center justify-between p-3 hover:bg-gray-50 rounded-lg transition">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center">
                                    <i class="fas fa-search text-yellow-600"></i>
                                </div>
                                <div>
                                    <p class="font-semibold text-gray-800 text-sm">GOOGL</p>
                                    <p class="text-xs text-gray-500">Alphabet Inc.</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="font-bold text-gray-800">$142.35</p>
                                <p class="text-xs text-green-600 flex items-center gap-1">
                                    <i class="fas fa-arrow-up"></i> +1.5%
                                </p>
                            </div>
                        </div>
                    </div>
                    <p class="text-xs text-gray-400 text-center mt-4">
                        <i class="fas fa-info-circle"></i> Prices update every 5 minutes
                    </p>
                </div>
            </div>

            <!-- Financial News -->
            <div class="bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden">
                <div class="bg-gradient-to-r from-orange-500 to-red-500 p-4">
                    <h4 class="font-semibold text-white flex items-center">
                        <i class="fas fa-newspaper mr-2"></i>
                        Financial News
                    </h4>
                </div>
                <div class="p-4 max-h-80 overflow-y-auto" id="financialNews">
                    <!-- News will be loaded here -->
                    <div class="space-y-4">
                        <a href="#" class="block p-3 hover:bg-gray-50 rounded-lg transition border-b border-gray-100">
                            <div class="flex gap-3">
                                <div class="w-20 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded flex-shrink-0 flex items-center justify-center">
                                    <i class="fas fa-newspaper text-white text-2xl"></i>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <h5 class="font-semibold text-sm text-gray-800 line-clamp-2 mb-1">
                                        Fed Signals Potential Rate Cut in December Meeting
                                    </h5>
                                    <p class="text-xs text-gray-500 flex items-center gap-2">
                                        <i class="far fa-clock"></i> 2 hours ago
                                    </p>
                                </div>
                            </div>
                        </a>
                        <a href="#" class="block p-3 hover:bg-gray-50 rounded-lg transition border-b border-gray-100">
                            <div class="flex gap-3">
                                <div class="w-20 h-16 bg-gradient-to-br from-green-500 to-green-600 rounded flex-shrink-0 flex items-center justify-center">
                                    <i class="fas fa-microchip text-white text-2xl"></i>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <h5 class="font-semibold text-sm text-gray-800 line-clamp-2 mb-1">
                                        Tech Stocks Rally on Strong Earnings Reports
                                    </h5>
                                    <p class="text-xs text-gray-500 flex items-center gap-2">
                                        <i class="far fa-clock"></i> 5 hours ago
                                    </p>
                                </div>
                            </div>
                        </a>
                        <a href="#" class="block p-3 hover:bg-gray-50 rounded-lg transition border-b border-gray-100">
                            <div class="flex gap-3">
                                <div class="w-20 h-16 bg-gradient-to-br from-orange-500 to-orange-600 rounded flex-shrink-0 flex items-center justify-center">
                                    <i class="fas fa-chart-bar text-white text-2xl"></i>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <h5 class="font-semibold text-sm text-gray-800 line-clamp-2 mb-1">
                                        Global Markets React to Inflation Data
                                    </h5>
                                    <p class="text-xs text-gray-500 flex items-center gap-2">
                                        <i class="far fa-clock"></i> 1 day ago
                                    </p>
                                </div>
                            </div>
                        </a>
                    </div>
                    <a href="#" class="block text-center text-sm text-blue-600 hover:text-blue-700 font-semibold mt-4">
                        View All News <i class="fas fa-arrow-right ml-1"></i>
                    </a>
                </div>
            </div>

            <!-- Ads & Promotions -->
            <div class="bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden">
                <div class="bg-gradient-to-r from-purple-500 to-pink-500 p-4">
                    <h4 class="font-semibold text-white flex items-center">
                        <i class="fas fa-bullhorn mr-2"></i>
                        Special Offers
                    </h4>
                </div>
                <div class="p-4 max-h-80 overflow-y-auto" id="promotions">
                    <!-- Ads will be loaded here -->
                    <div class="space-y-4">
                        <!-- Ad 1 -->
                        <div class="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-200">
                            <div class="flex items-start gap-3">
                                <div class="bg-blue-500 p-2 rounded-lg flex-shrink-0">
                                    <i class="fas fa-credit-card text-white text-xl"></i>
                                </div>
                                <div class="flex-1">
                                    <h5 class="font-bold text-gray-800 text-sm mb-1">Premium Credit Card</h5>
                                    <p class="text-xs text-gray-600 mb-2">Get 5% cashback on all purchases. Zero annual fee for first year!</p>
                                    <button class="bg-blue-500 hover:bg-blue-600 text-white text-xs px-3 py-1.5 rounded-full transition">
                                        Learn More
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Ad 2 -->
                        <div class="bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg p-4 border border-green-200">
                            <div class="flex items-start gap-3">
                                <div class="bg-green-500 p-2 rounded-lg flex-shrink-0">
                                    <i class="fas fa-piggy-bank text-white text-xl"></i>
                                </div>
                                <div class="flex-1">
                                    <h5 class="font-bold text-gray-800 text-sm mb-1">High Yield Savings</h5>
                                    <p class="text-xs text-gray-600 mb-2">Earn up to 4.5% APY on your savings. Start saving today!</p>
                                    <button class="bg-green-500 hover:bg-green-600 text-white text-xs px-3 py-1.5 rounded-full transition">
                                        Open Account
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Ad 3 -->
                        <div class="bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg p-4 border border-purple-200">
                            <div class="flex items-start gap-3">
                                <div class="bg-purple-500 p-2 rounded-lg flex-shrink-0">
                                    <i class="fas fa-chart-pie text-white text-xl"></i>
                                </div>
                                <div class="flex-1">
                                    <h5 class="font-bold text-gray-800 text-sm mb-1">Investment Portfolio</h5>
                                    <p class="text-xs text-gray-600 mb-2">Professional portfolio management. Min. investment $1,000</p>
                                    <button class="bg-purple-500 hover:bg-purple-600 text-white text-xs px-3 py-1.5 rounded-full transition">
                                        Get Started
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Verification Modal -->
    <div id="verificationModal" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-[100] flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 transform transition-all scale-95" id="modalContent">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-gray-800">Contact Customer Service</h3>
                <button id="closeModalBtn" class="text-gray-400 hover:text-gray-600 transition">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <p class="text-gray-600 mb-6">Choose your preferred method to complete account verification:</p>
            
            <div class="space-y-3 mb-6">
                <!-- WhatsApp Option (Recommended) -->
                <a href="https://wa.me/447422860976?text=Hi,%20I%20need%20help%20verifying%20my%20RAIL%20account.%20My%20username%20is%20{{user.username}}" 
                    target="_blank"
                    class="flex items-center gap-4 p-4 bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-500 rounded-xl hover:shadow-lg transition-all group">
                    <div class="bg-green-500 p-3 rounded-full">
                        <i class="fab fa-whatsapp text-white text-2xl"></i>
                    </div>
                    <div class="flex-1">
                        <div class="flex items-center gap-2">
                            <h4 class="font-bold text-gray-800">WhatsApp</h4>
                            <span class="bg-green-500 text-white text-xs px-2 py-0.5 rounded-full">Recommended</span>
                        </div>
                        <p class="text-sm text-gray-600">For urgent assistance</p>
                    </div>
                    <i class="fas fa-arrow-right text-green-600 group-hover:translate-x-1 transition-transform"></i>
                </a>
                
                <!-- Email Option -->
                <!-- TODO: Set your support email below -->
                <a href="mailto:YOUR_SUPPORT_EMAIL_HERE?subject=Account%20Verification%20Request%20-%20{{user.username}}&body=Hello%20RAIL%20Support%20Team,%0D%0A%0D%0AI%20need%20assistance%20with%20verifying%20my%20account.%0D%0A%0D%0AUsername:%20{{user.username}}%0D%0AAccount%20Number:%20{% for detail in details %}{{detail.account_number}}{% endfor %}%0D%0A%0D%0AThank%20you."
                    class="flex items-center gap-4 p-4 bg-gray-50 border-2 border-gray-200 rounded-xl hover:shadow-lg hover:border-blue-400 transition-all group">
                    <div class="bg-blue-500 p-3 rounded-full">
                        <i class="fas fa-envelope text-white text-2xl"></i>
                    </div>
                    <div class="flex-1">
                        <h4 class="font-bold text-gray-800">Email</h4>
                        <p class="text-sm text-gray-600">Response within 24 hours</p>
                    </div>
                    <i class="fas fa-arrow-right text-blue-600 group-hover:translate-x-1 transition-transform"></i>
                </a>
            </div>
            
            <!-- In-App Chat Reminder -->
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 flex items-start gap-3">
                <i class="fas fa-info-circle text-blue-500 text-sm mt-0.5"></i>
                <p class="text-xs text-blue-800">
                    <span class="font-semibold">Tip:</span> You can also chat with customer care directly within the app using the 
                    <a href="{% url 'chat_list' %}" class="underline font-semibold hover:text-blue-600">chat icon</a> at the top.
                </p>
            </div>
        </div>
    </div>

    <script>
        // Profile menu toggle
        const profileMenuBtn = document.getElementById('profileMenuBtn');
        const profileMenu = document.getElementById('profileMenu');

        profileMenuBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            profileMenu.classList.toggle('hidden');
        });

        // Close menu when clicking outside
        document.addEventListener('click', (e) => {
            if (!profileMenu.contains(e.target) && !profileMenuBtn.contains(e.target)) {
                profileMenu.classList.add('hidden');
            }
        });

        // Notification panel toggle
        const notificationBtn = document.getElementById('notificationBtn');
        const notificationPanel = document.getElementById('notificationPanel');

        if (notificationBtn) {
            notificationBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                notificationPanel.classList.toggle('hidden');
            });
        }

        // Close notification panel when clicking outside
        document.addEventListener('click', (e) => {
            if (notificationPanel && !notificationPanel.contains(e.target) && !notificationBtn.contains(e.target)) {
                notificationPanel.classList.add('hidden');
            }
        });

        // Verification Modal
        const verifyBtn = document.getElementById('verifyNowBtn');
        const modal = document.getElementById('verificationModal');
        const modalContent = document.getElementById('modalContent');
        const closeModalBtn = document.getElementById('closeModalBtn');

        if (verifyBtn) {
            verifyBtn.addEventListener('click', (e) => {
                e.preventDefault();
                modal.classList.remove('hidden');
                setTimeout(() => {
                    modalContent.classList.remove('scale-95');
                    modalContent.classList.add('scale-100');
                }, 10);
            });
        }

        function closeModal() {
            modalContent.classList.remove('scale-100');
            modalContent.classList.add('scale-95');
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 200);
        }

        if (closeModalBtn) {
            closeModalBtn.addEventListener('click', closeModal);
        }

        // Close modal when clicking outside
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                closeModal();
            }
        });
    </script>
</body>

</html>